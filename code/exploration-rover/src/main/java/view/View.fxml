<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.canvas.Canvas?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>

<BorderPane prefHeight="900" prefWidth="1280" styleClass="root" stylesheets="@styles.css" xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1" fx:controller="view.View">

    <!-- TOP BAR -->
    <top>
        <HBox alignment="CENTER_LEFT" spacing="12" styleClass="topbar">
            <padding>
                <Insets bottom="14" left="14" right="14" top="14" />
            </padding>

            <Label styleClass="statusDot" text="*" />

            <VBox spacing="2">
                <Label styleClass="title" text="Tableau de bord Sonar et Capteurs" />
                <Label styleClass="subtitle" text="Monitoring System v1.5" />
            </VBox>

            <Region HBox.hgrow="ALWAYS" />

            <Label fx:id="lblStatusPill" styleClass="pill" text="Status : En ligne" />
            <Button styleClass="iconBtn" text="[ ]" />
        </HBox>
    </top>

    <center>
        <VBox spacing="14" styleClass="page" BorderPane.alignment="CENTER">
            <padding>
                <Insets bottom="14" left="14" right="14" top="14" />
            </padding>

            <!-- Main row -->
            <HBox spacing="14">

                <!-- SONAR / RADAR -->
                <VBox spacing="10" styleClass="card" HBox.hgrow="ALWAYS">
                    <HBox alignment="CENTER_LEFT">
                        <VBox spacing="2">
                            <Label styleClass="cardTitle" text="Visualisation Radar" />
                            <Label styleClass="cardSub" text="Angles fixes: 0째 / -20째 / +20째" />
                        </VBox>
                        <Region HBox.hgrow="ALWAYS" />
                    </HBox>

                    <StackPane fx:id="radarContainer" styleClass="panel" minHeight="320.0" prefHeight="380.0" VBox.vgrow="ALWAYS">
                        <Canvas fx:id="radarCanvas" />
                    </StackPane>

                    <HBox spacing="8" alignment="CENTER_LEFT">
                        <Label styleClass="muted" text="SONAR :" />
                        <Label fx:id="lblSonarDistance" styleClass="bigValue" prefWidth="70" text="?" />
                        <Label styleClass="unit" text="mm" />
                        <Label styleClass="muted" text="DST G :" />
                        <Label fx:id="lblDstLeft" styleClass="bigValue" prefWidth="70" text="?" />
                        <Label styleClass="unit" text="mm" />
                        <Label styleClass="muted" text="DST D :" />
                        <Label fx:id="lblDstRight" styleClass="bigValue" prefWidth="70" text="?" />
                        <Label styleClass="unit" text="mm" />
                        <Region HBox.hgrow="ALWAYS" />
                        <Label fx:id="lblRadarHint" styleClass="pill" text="-" />
                        <Label fx:id="lblSonarStatus" styleClass="mutedSmall" text="Sonar: ?" />
                    </HBox>
                </VBox>

                <!-- RIGHT SENSORS -->
                <VBox prefWidth="360" spacing="10" styleClass="card">
                    <HBox alignment="CENTER_LEFT">
                        <Label styleClass="cardTitle" text="Donnees Capteurs" />
                        <Region HBox.hgrow="ALWAYS" />
                        <Button fx:id="btnReinitialiser" styleClass="linkBtn" text="Generer PDF mission" />
                    </HBox>

                    <!-- Temp -->
                    <VBox spacing="8" styleClass="miniCard">
                        <Label styleClass="miniTitle" text="Temperature" />
                        <HBox alignment="BASELINE_LEFT" spacing="6">
                            <Label fx:id="lblTemperature" styleClass="bigValue" />
                            <Label styleClass="unit" text="째C" />
                        </HBox>
                        <Label styleClass="mutedSmall" text="-" />
                    </VBox>

                    <!-- Humidite -->
                    <VBox spacing="8" styleClass="miniCard">
                        <Label styleClass="miniTitle" text="Humidite relative" />
                        <HBox alignment="BASELINE_LEFT" spacing="6">
                        <Label fx:id="lblHumidite" styleClass="bigValue" />
                        <!-- Escaper pour afficher un pourcentage -->
                        <Label styleClass="unit" text="%%" />
                        </HBox>
                        <Label styleClass="mutedSmall" text="Zone de confort" />
                    </VBox>

                    <!-- Lumiere -->
                    <VBox spacing="8" styleClass="miniCard">
                        <Label styleClass="miniTitle" text="Intensite lumiere" />
                        <HBox alignment="BASELINE_LEFT" spacing="6">
                            <Label fx:id="lblLuminosite" styleClass="bigValue" />
                            <Label styleClass="unit" text="Lux" />
                        </HBox>
                        <Label styleClass="mutedSmall" />
                    </VBox>

                    <VBox spacing="8" styleClass="miniCard">
                        <Label styleClass="miniTitle" text="Message systeme" />
                        <Label fx:id="lblMessage" styleClass="sensorMessage" text="..." wrapText="true" />
                    </VBox>
                </VBox>

            </HBox>

            <!-- FIL D'ARIANE -->
            <VBox spacing="10" styleClass="card" VBox.vgrow="ALWAYS">
                <HBox alignment="CENTER_LEFT">
                    <VBox spacing="2">
                        <Label styleClass="cardTitle" text="Fil d'Ariane" />
                        <Label styleClass="cardSub" text="Suivi de trajectoire" />
                    </VBox>
                    <Region HBox.hgrow="ALWAYS" />
                    <Label fx:id="lblFilArianeStats" styleClass="pill" text="X: 0.00  Y: 0.00  Dist: 0.0m" minWidth="220" prefWidth="220" maxWidth="220" alignment="CENTER_RIGHT" />
                </HBox>

                <StackPane fx:id="filArianeContainer" minHeight="160" prefHeight="220" styleClass="panel" VBox.vgrow="ALWAYS">
                    <Canvas fx:id="filArianeCanvas" />
                </StackPane>
            </VBox>

        </VBox>
    </center>

</BorderPane>
